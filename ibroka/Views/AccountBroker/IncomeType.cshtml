@model IEnumerable<ibroka.Models.AccountBroker.IncomeType> 


@{
  ViewData["Title"] = "Income Type";
   Layout = "~/Views/Shared/_LayoutAccountBrokers.cshtml";
}


<div class="content">
  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header">
            <div class="row">
                <div class="col-md-10">
                    <h4 class="card-title"> Income Type</h4>
                </div>
                <div class="col-md-2">
                    @*<a asp-action="AddEmployee" asp-controller="Employees" class="btn btn-fill btn-info">Add New Employee</a>*@
                    <button class="btn btn-info " data-toggle="modal" data-target="#noticeModal">
                        <span class="btn-label">
                            <i class="now-ui-icons travel_info"></i>
                        </span>
                        Create
                    </button>
                </div>
            </div>
          <!-- notice modal -->
          <div class="modal fade" id="noticeModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-notice">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    <i class="now-ui-icons ui-1_simple-remove"></i>
                  </button>
                  <h5 class="modal-title" id="myModalLabel">Enter New Income Type</h5>
                </div>
                <div class="modal-body">
                  <div class="instruction">
                      <form>
                          <div class="row">
                              <div class="col-md-12">
                                  <div class="form-group">
                                      <label> Name</label>
                                      <input type="text" class="form-control" placeholder=" Name" id="IncomeName" name="IncomeName" required>
                                  </div>
                              </div>
                          </div>
                          <div class="row">
                              <div class="col-md-12">
                                  <div class="form-group">
                                      <label>Description</label>
                                      <textarea class="form-control" placeholder="Description" id="Description" required rows="3"></textarea>
                                      @*<input type="text" class="form-control" placeholder="Department Name" id="Description" name="Description" required>*@

                                  </div>
                              </div>
                          </div>
                         
                          <div class="card-footer">
                              <button type="button" class="btn btn-fill btn-primary btn-round" id="SubmitNewIncomeType">Submit</button>
                              <button type="button" class="btn btn-info btn-round" data-dismiss="modal">Close</button>
                          </div>
                      </form>
                  </div>
                </div>
                @*<div class="modal-footer justify-content-center">
                      <button type="button" class="btn btn-info btn-round" data-dismiss="modal">Sounds good!</button>
                  </div>*@
              </div>
            </div>
          </div>
          <!-- end notice modal -->
          <!-- notice Edit modal -->
          <div class="modal fade" id="noticeModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-notice">
                  <div class="modal-content">
                      <div class="modal-header">
                          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                              <i class="now-ui-icons ui-1_simple-remove"></i>
                          </button>
                          <h5 class="modal-title" id="myModalLabel">Enter New Income Type</h5>
                      </div>
                      <div class="modal-body">
                          <div class="instruction">
                              <form>
                                  <div class="row">
                                      <div class="col-md-12">
                                          <div class="form-group">
                                              <label> Name</label>
                                              <input type="text" class="form-control" placeholder=" Name" id="IncomeName" name="IncomeName" required>
                                          </div>
                                      </div>
                                  </div>
                                  <div class="row">
                                      <div class="col-md-12">
                                          <div class="form-group">
                                              <label>Description</label>
                                              <textarea class="form-control" placeholder="Description" id="Description" required rows="3"></textarea>
                                              @*<input type="text" class="form-control" placeholder="Department Name" id="Description" name="Description" required>*@

                                          </div>
                                      </div>
                                  </div>

                                  <div class="card-footer">
                                      <button type="button" class="btn btn-fill btn-primary btn-round" id="SubmitNewIncomeType">Submit</button>
                                      <button type="button" class="btn btn-info btn-round" data-dismiss="modal">Close</button>
                                  </div>
                              </form>
                          </div>
                      </div>
                      @*<div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-info btn-round" data-dismiss="modal">Sounds good!</button>
                </div>*@
                  </div>
              </div>
          </div>
          <!-- end notice Edit modal -->
          @*<button type="submit" class="btn btn-fill btn-info">Add Employee</button>*@
        </div>
        

        <div class="card-body">
          <div>
            <table class="table table-striped" id="datatable" cellspacing="10" width="100%">
              <thead class="text-primary">
              <th class="text-center">
                #
              </th>
              <th>
                  Income Name
              </th>
              
              <th>
                Description
              </th>
              
              <th>
                Action
              </th>

              </thead>


              <tbody>

                @{
                    int i = 1;

                    @if (Model.Count() < 1)
                    {
                    
                    <td></td>
                    <td></td>
                    <td>No Data to Display</td>
                    <td></td>
                    <td></td>
                

                }


                    foreach (var item in Model)
                    {

                        <tr>
                            <td class="text-center">
                                @i
                            </td>

                         
                            <td>
                                @item.IncomeName
                            </td>
                            <td>
                                @item.Description
                            </td>
                           
                            <td>
                                <span data-toggle="modal" data-target="noticeModal1"><a href="#" class="btn btn-round btn-warning btn-icon btn-sm" title="Click to Edit" id="Editbtn" data-toggle="modal" data-target="noticeModal1"  @*EditAddId="@item.Id" Selected-IncomeName="@item.IncomeName" Selected-Description="@item.Description"*@><i class="far fa-edit"></i></a></span>
                                <a href="#" class="btn btn-round btn-danger btn-icon btn-sm remove" title="Click to Delete"><i class="fas fa-times"></i></a>

                            </td>
                        </tr>

                        { i = i + 1; }
                    }
                }

                </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

  </div>

</div>




<script>
  $(document).ready(function () {
    $('#datatable').DataTable({
      "pagingType": "full_numbers",
      "lengthMenu": [
        [10, 25, 50, -1],
        [10, 25, 50, "All"]
      ],
      responsive: true,

      language: {
        search: "_INPUT_",
        searchPlaceholder: "Search records",
      }

    });

    var table = $('#datatable').DataTable();

    // Edit record
    table.on('click', '.edit', function () {
      $tr = $(this).closest('tr');

      var data = table.row($tr).data();
      alert('You press on Row: ' + data[0] + ' ' + data[1] + ' ' + data[2] + '\'s row.');
    });

    // Delete a record
    table.on('click', '.remove', function (e) {
      $tr = $(this).closest('tr');
      table.row($tr).remove().draw();
      e.preventDefault();
    });

    //Like record
    table.on('click', '.like', function () {
      alert('You clicked on Like button');
    });
  });


</script>



@section Scripts {

  <!--  DataTables.net Plugin, full documentation here  -->
  <script src="~/assets/js/plugins/jquery.dataTables.min.js"></script>

  @*<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  <script src="//code.jquery.com/jquery-1.10.2.js"></script>
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>*@
  

  <script type="text/javascript">

    $(document).ready(function () {

      $("#SubmitNewIncomeType").click(function (event) {

        event.preventDefault();

        var IncomeType = {        
          IncomeName: $("#IncomeName").val(),
          Description: $("#Description").val(),                  
        };


        console.log(IncomeType);

        $.ajax({
          type: "POST",
          url: "/AccountBroker/PostIncomeType",
          data: JSON.stringify(IncomeType),
          dataType: "json",
          contentType: 'application/json; charset=utf-8',
          headers: {
            RequestVerificationToken:
              $('input:hidden[name="__RequestVerificationToken"]').val()
          },
          success: function (r) {

            if (r.msg == "Success") {

              demo.showSwal('success-message');

            } else if (r.msg == "Fail") {

              alert(r.msg);

            } else if (r.msg == "No Data") {
              alert(r.msg);

            } else {
              alert(r.msg);
            }
            //alert(r.msg);
            // window.location.reload();

          },
          error: function () {
            alert(r.msg);
          }
        });
      });
    });


    //Code for pulling the Records on the Table
    var aEditAddId;

    $(document).delegate('#Editbtn',
      'click',
      function (e) {

          aEditAddId = $(this).attr('EditAddId');         
          IncomeName = $(this).attr('Selected-IncomeName');
          description = $(this).attr('Selected-Description');


        //console.log(varstartDate, varendDate);
        //  console.log(aEditAssetId);

        $('input[name=AddSalId]').val(aEditAddId);
        $('input[name=eincomeName]').val(incomeName);
        $('textarea[name=eDescription]').val(description);

      });

    //End of the code

    $(document).ready(function () {

      $("#submitEditAdditions").click(function (event) {

        event.preventDefault();

        var PostSalaryDeduction = {
          AId: $("#AddSalId").val(),
          EmployeeDetailsId: $("#eemployeeId").val(),
          AdditonId: $("#eAdditionType").val(),
          Amount: $("#eAmount").val(),
          Description: $("#eDescription").val(),
        };


        // console.log(Items);
        console.log(PostSalaryDeduction);

        $.ajax({
          type: "POST",
          url: "/Payroll/editSalaryAdditions",
          data: JSON.stringify(PostSalaryDeduction),
          dataType: "json",
          contentType: 'application/json; charset=utf-8',
          headers: {
            RequestVerificationToken:
              $('input:hidden[name="__RequestVerificationToken"]').val()
          },
          success: function (r) {

            if (r.msg == "Success") {

              demo.showSwal('success-message');

            } else if (r.msg == "Fail") {

              alert(r.msg);

            } else if (r.msg == "No Data") {
              alert(r.msg);

            } else {
              alert(r.msg);
            }
            //alert(r.msg);
            // window.location.reload();

          },
          error: function () {
            alert(r.msg);
          }
        });
      });



    });

  </script>

}


